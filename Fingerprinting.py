"""
Fingerprinting della chiave generata con Keygen.py
N = (k ∗ M + 65537a mod M) ∗ (l ∗ M + 65537b mod M) = p * q
for a,b, k,l ∈ Z.
N ≡ 65537^(a+b) ≡ 65537^c mod M
for some integer c.
The existence of the discrete logarithm c = log65537 N mod M is used as the
fingerprint of the public modulus N generated by the RSALib.
"""
from sympy.ntheory.residue_ntheory import _discrete_log_pohlig_hellman
from sympy import primorial
from Keygen import bits_check

e=0x10001
def fingprint(N):

    n=bits_check(N.bit_length())

    M=primorial(n)
    try:
        c=_discrete_log_pohlig_hellman(M,N,e)
        return True
    except:
        return False
